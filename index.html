<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle Roku GOD MODE</title>

<style>

body{
    background:#111;
    color:white;
    text-align:center;
    font-family:Arial;
    padding:10px;
}

.container{
    display:flex;
    flex-direction:column;
    align-items:center;
}

input{
    padding:10px;
    border-radius:8px;
    border:none;
    width:90%;
    max-width:320px;
    font-size:16px;
    margin-bottom:15px;
}

button{
    background:#1c1c1c;
    color:white;
    border:2px solid black;
    width:90px;
    height:55px;
    font-size:15px;
    border-radius:12px;
    cursor:pointer;
    margin:4px;
}

button:hover{
    background:#2a2a2a;
}

.direcional{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:8px;
}

.linha-meio{
    display:flex;
    gap:8px;
}

.direcional button{
    background:#6f2dbd;
    border:2px solid #4b0082;
    width:110px;
    height:60px;
}

.ok{
    width:85px !important;
    height:85px !important;
    border-radius:50%;
    font-weight:bold;
}

.titulo{
    color:#6f2dbd;
    font-size:32px;
}

</style>
</head>

<body>

<h1 class="titulo">Controle Roku GOD MODE</h1>

<div class="container">

<input type="text" id="ip" placeholder="IP do Roku">

<br>

<button onclick="scannerGodMode()">üöÄ AUTO BUSCAR</button>

<p id="status"></p>

<br>

<div>
<button onclick="enviar('Home')">In√≠cio</button>
<button onclick="enviar('Back')">Voltar</button>
</div>

<br>

<div class="direcional">

<button onclick="enviar('Up')">‚Üë</button>

<div class="linha-meio">
<button onclick="enviar('Left')">‚Üê</button>
<button class="ok" onclick="enviar('Select')">OK</button>
<button onclick="enviar('Right')">‚Üí</button>
</div>

<button onclick="enviar('Down')">‚Üì</button>

</div>

<br>

<div>
<button onclick="enviar('VolumeUp')">Volume +</button>
<button onclick="enviar('VolumeDown')">Volume -</button>
<button onclick="enviar('VolumeMute')">Mudo</button>
</div>

</div>

<script>

/* enviar comando */
function enviar(comando){

    const ip = document.getElementById("ip").value.trim();

    if(!ip){
        alert("Busque ou digite o IP");
        return;
    }

    fetch(`http://${ip}:8060/keypress/${comando}`,{
        method:"POST"
    }).catch(()=>{});
}

/* descobrir gateway da rede */
function getRedeProvavel(){

    const base = ["192.168.0.","192.168.1.","10.0.0."];

    return base[Math.floor(Math.random()*base.length)];
}

/* scanner GOD MODE */
async function scannerGodMode(){

    const status = document.getElementById("status");

    status.innerText = "üöÄ Procurando dispositivo...";

    const rede = getRedeProvavel();

    let promessas = [];

    for(let i=1;i<=254;i++){

        const ip = rede+i;

        promessas.push(
            (async()=>{
                try{

                    const controller = new AbortController();
                    setTimeout(()=>controller.abort(),400);

                    await fetch(`http://${ip}:8060`,{
                        mode:"no-cors",
                        signal:controller.signal
                    });

                    return ip;

                }catch{
                    return null;
                }
            })()
        );
    }

    const resultado = await Promise.all(promessas);

    const encontrado = resultado.find(x=>x!==null);

    if(encontrado){

        document.getElementById("ip").value = encontrado;

        status.innerText = "‚úÖ Encontrado: "+encontrado;

    }else{
        status.innerText = "‚ùå N√£o encontrado";
    }
}

</script>

</body>
</html>
